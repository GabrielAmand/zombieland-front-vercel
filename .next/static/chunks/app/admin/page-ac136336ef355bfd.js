(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{2383:(e,t,r)=>{"use strict";r.d(t,{e:()=>n});var a=r(9509);function n(){if(!a.env.NEXT_PUBLIC_API_URL)throw Error("NEXT_PUBLIC_API_URL n'est pas d\xe9finie.");return a.env.NEXT_PUBLIC_API_URL}},2440:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>A});var a=r(5155),n=r(5695),s=r(2115),i=r(4616),o=r(3717),l=r(2525),c=r(4837),d=r(4831),u=r(2383);function m(e){let{hasMore:t,onClick:r}=e;return t?(0,a.jsx)("div",{className:"text-center mt-6",children:(0,a.jsx)("button",{type:"button",onClick:r,className:"bg-primary text-bg px-6 py-2 rounded-lg font-bold hover:bg-primary-dark",children:"Afficher plus"})}):null}function p(){let{token:e}=(0,d.W)(),[t,r]=(0,s.useState)([]),[n,p]=(0,s.useState)(!1),[h,x]=(0,s.useState)(!1),[f,b]=(0,s.useState)(null),[j,y]=(0,s.useState)(!1),[g,v]=(0,s.useState)(4),[C,N]=(0,s.useState)(""),[w,A]=(0,s.useState)(""),E=t.slice(0,g),S=g<t.length,k=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),T=(0,s.useCallback)(async()=>{try{let t=await fetch("".concat((0,u.e)(),"/admin/attractions"),{headers:{Authorization:"Bearer ".concat(e)},credentials:"include"}),a=await t.json();if(t.ok)r(a.allAttractions);else throw Error("Erreur API")}catch(e){console.error(e)}},[e]);(0,s.useEffect)(()=>{T()},[T]);let z=async()=>{if(f)try{if(!(await fetch("".concat((0,u.e)(),"/admin/attractions/").concat(f.id),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},credentials:"include",body:JSON.stringify({name:C,description:w,slug:k(C),image:"".concat(k(C),".webp")})})).ok)throw Error("Erreur de soumission");await T(),p(!1),b(null),N(""),A("")}catch(e){console.error(e)}},O=async()=>{try{if(console.log(JSON.stringify({name:C,description:w,slug:k(C),image:"".concat(k(C),".webp")})),!(await fetch("".concat((0,u.e)(),"/admin/attractions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},credentials:"include",body:JSON.stringify({name:C,description:w,slug:k(C),image:"".concat(k(C),".webp")})})).ok)throw Error("Erreur de cr\xe9ation");await T(),y(!1),N(""),A("")}catch(e){console.error(e)}},_=async()=>{if(f)try{let t=await fetch("".concat((0,u.e)(),"/admin/attractions/").concat(f.id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)},credentials:"include"});if(!t.ok){let e=await t.json();throw console.error("Erreur suppression:",e),Error("Suppression \xe9chou\xe9e")}await T(),x(!1),b(null)}catch(e){console.error(e)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("section",{className:"mb-10",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsx)("h2",{className:"text-xl font-subtitle text-primary-light",children:"Gestion des attractions"}),(0,a.jsx)("button",{type:"button",onClick:()=>{y(!0),N(""),A(""),b(null)},className:"text-primary hover:text-primary-dark",children:(0,a.jsx)(i.A,{})})]}),(0,a.jsx)("ul",{className:"space-y-2",children:E.map((e,t)=>(0,a.jsxs)("li",{className:"flex justify-between items-center px-4 py-2 bg-surface border border-muted rounded",children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(o.A,{onClick:()=>{p(!0),b(e),N(e.name),A(e.description)},className:"size-4 text-primary cursor-pointer"}),(0,a.jsx)(l.A,{className:"size-4 text-red-500 cursor-pointer",onClick:()=>{x(!0),b(e),N(e.name),A(e.description)}})]})]},t))}),(0,a.jsx)(m,{hasMore:S,onClick:()=>v(e=>e+4)})]}),(0,a.jsxs)(c.A,{isOpen:n,onClose:()=>{p(!1),b(null)},title:"Modifier l'attraction",confirmText:"Confirmer",onConfirm:z,children:[(0,a.jsx)("input",{value:C,onChange:e=>N(e.target.value),className:"w-full mb-2 p-2 border rounded"}),(0,a.jsx)("textarea",{value:w,onChange:e=>A(e.target.value),className:"w-full p-2 border rounded"})]}),(0,a.jsxs)(c.A,{isOpen:j,onClose:()=>{y(!1),b(null)},title:"Cr\xe9er une attraction",confirmText:"Cr\xe9er",onConfirm:O,children:[(0,a.jsx)("input",{value:C,onChange:e=>N(e.target.value),className:"w-full mb-2 p-2 border rounded",placeholder:"Nom"}),(0,a.jsx)("textarea",{value:w,onChange:e=>A(e.target.value),className:"w-full p-2 border rounded",placeholder:"Description"})]}),(0,a.jsx)(c.A,{isOpen:h,onClose:()=>{x(!1),b(null)},title:"Confirmer la supression",confirmText:"Confirmer la supression",onConfirm:_,children:(0,a.jsx)("p",{className:"text-text font-body",children:"\xcates-vous certain de vouloir supprimer l'attraction ? Toute suppression sera d\xe9finitive."})})]})}function h(e){let{title:t,onCreate:r}=e;return(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsx)("h2",{className:"text-xl font-subtitle text-primary-light",children:t}),(0,a.jsx)("button",{type:"button",className:"text-primary hover:text-primary-dark",onClick:r,children:(0,a.jsx)(i.A,{})})]})}function x(e){let{title:t,onCreate:r,children:n}=e;return(0,a.jsxs)("section",{className:"mb-10 text-text font-body",children:[(0,a.jsx)(h,{title:t,onCreate:r}),n]})}var f=r(5258),b=r.n(f);function j(e){let{items:t=[],onEdit:r,onDelete:n}=e;return(0,a.jsx)("ul",{className:"space-y-2",children:t.map((e,t)=>(0,a.jsxs)("li",{className:"flex justify-between items-center px-4 py-2 bg-surface border border-muted rounded",children:[(0,a.jsx)("span",{children:b().decode(e.name)}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(o.A,{className:"size-4 text-primary cursor-pointer",onClick:()=>null==r?void 0:r(t)}),(0,a.jsx)(l.A,{className:"size-4 text-red-500 cursor-pointer",onClick:()=>null==n?void 0:n(t)})]})]},e.id))})}function y(){let{token:e}=(0,d.W)(),[t,r]=(0,s.useState)([]),[n,i]=(0,s.useState)(4),[o,l]=(0,s.useState)(null),[p,h]=(0,s.useState)(!1),[f,b]=(0,s.useState)(!1),[y,g]=(0,s.useState)(!1),[v,C]=(0,s.useState)(""),[N,w]=(0,s.useState)(!1),[A,E]=(0,s.useState)(null),[S,k]=(0,s.useState)({}),T=(0,s.useCallback)(async()=>{try{let t=await fetch("".concat((0,u.e)(),"/admin/categories"),{headers:{Authorization:"Bearer ".concat(e)},credentials:"include"}),a=await t.json();r(a.categories||[])}catch(e){console.error("Erreur lors du fetch des cat\xe9gories :",e)}},[e]);(0,s.useEffect)(()=>{e&&T()},[e,T]);let z=async()=>{if(o&&v){w(!0),k({}),E(null);try{let t=await fetch("".concat((0,u.e)(),"/admin/categories/").concat(o.id),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({name:v}),credentials:"include"}),r=await t.json();if(!t.ok){if(400===t.status&&Array.isArray(r.error)){let e=Object.fromEntries(r.error.map(e=>[e.path[0],e.message]));k(e);return}E("Erreur inattendue.");return}T(),h(!1),C("")}catch(e){console.error("Erreur modification :",e),E("Erreur de connexion au serveur.")}finally{w(!1)}}},O=async()=>{if(o){w(!0);try{(await fetch("".concat((0,u.e)(),"/admin/categories/").concat(o.id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)},credentials:"include"})).ok&&(r(e=>e.filter(e=>e.id!==o.id)),b(!1))}catch(e){console.error("Erreur suppression :",e)}finally{w(!1)}}},_=async()=>{if(v){w(!0),k({}),E(null);try{let t=await fetch("".concat((0,u.e)(),"/admin/categories"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({name:v}),credentials:"include"}),r=await t.json();if(!t.ok){if(400===t.status&&Array.isArray(r.error)){let e=Object.fromEntries(r.error.map(e=>[e.path[0],e.message]));k(e);return}E("Erreur inattendue.");return}T(),g(!1),C("")}catch(e){console.error("Erreur cr\xe9ation :",e),E("Erreur de connexion au serveur.")}finally{w(!1)}}},P=t.slice(0,n),B=n<t.length;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(x,{title:"Gestion des cat\xe9gories",onCreate:()=>{C(""),k({}),E(null),g(!0)},children:[(0,a.jsx)(j,{items:P,onEdit:e=>{var t;l(t=P[e]),C(t.name),k({}),E(null),h(!0)},onDelete:e=>(e=>{let r=t.find(t=>t.id===e);r&&(l(r),b(!0))})(P[e].id)}),(0,a.jsx)(m,{hasMore:B,onClick:()=>i(e=>e+4)})]}),(0,a.jsxs)(c.A,{isOpen:p,title:"Modifier la cat\xe9gorie",confirmText:"Modifier",onClose:()=>h(!1),onConfirm:z,disableConfirm:!v,loading:N,children:[(0,a.jsx)("input",{type:"text",value:v,onChange:e=>C(e.target.value),className:"w-full rounded p-2 border ".concat(S.name?"border-red-500":"border-muted"),"aria-invalid":!!S.name}),S.name&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:S.name}),A&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-2",children:A})]}),(0,a.jsx)(c.A,{isOpen:f,title:"Supprimer la cat\xe9gorie",confirmText:"Supprimer",onClose:()=>b(!1),onConfirm:O,loading:N,children:(0,a.jsx)("p",{className:"text-text font-body",children:"\xcates-vous s\xfbr de vouloir supprimer cette cat\xe9gorie ?"})}),(0,a.jsxs)(c.A,{isOpen:y,title:"Cr\xe9er une cat\xe9gorie",confirmText:"Cr\xe9er",onClose:()=>g(!1),onConfirm:_,disableConfirm:!v,loading:N,children:[(0,a.jsx)("input",{type:"text",value:v,onChange:e=>C(e.target.value),className:"w-full rounded p-2 border ".concat(S.name?"border-red-500":"border-muted"),"aria-invalid":!!S.name}),S.name&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:S.name}),A&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-2",children:A})]})]})}function g(){let{token:e}=(0,d.W)(),[t,r]=(0,s.useState)([]),[n,i]=(0,s.useState)(4),[o,l]=(0,s.useState)(null),[p,h]=(0,s.useState)(!1),[f,b]=(0,s.useState)(!1),[y,g]=(0,s.useState)(!1),[C,N]=(0,s.useState)(!1),[w,A]=(0,s.useState)(!1),[E,S]=(0,s.useState)({firstname:"",lastname:"",email:"",phone:"",admin:!1,password:""}),[k,T]=(0,s.useState)({}),z=(0,s.useCallback)(async()=>{try{let t=await fetch("".concat((0,u.e)(),"/admin/users"),{headers:{Authorization:"Bearer ".concat(e)},credentials:"include"}),a=await t.json();r(a)}catch(e){console.error("Erreur fetch membres :",e)}},[e]);(0,s.useEffect)(()=>{e&&z()},[e,z]);let O=async()=>{if(o){N(!0),T({});try{let t=E.phone.replace(/\D/g,""),{firstname:r,lastname:a,email:n,admin:s}=E,i={firstname:r,lastname:a,email:n,phone:t,admin:s};console.log("Payload envoy\xe9 :",i);let l=await fetch("".concat((0,u.e)(),"/admin/users/").concat(o.id),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},credentials:"include",body:JSON.stringify(i)}),c=await l.json();if(!l.ok){if(400===l.status&&Array.isArray(c.errors)){let e=Object.fromEntries(c.errors.map(e=>[e.path[0],e.message]));T(e);return}console.error("Erreur modification membre :",c);return}z(),h(!1)}catch(e){console.error("Erreur modification membre :",e)}finally{N(!1)}}},_=async()=>{if(o){N(!0);try{(await fetch("".concat((0,u.e)(),"/admin/users/").concat(o.id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)},credentials:"include"})).ok&&(r(e=>e.filter(e=>e.id!==o.id)),b(!1))}catch(e){console.error("Erreur suppression membre :",e)}finally{N(!1)}}},P=async()=>{N(!0),T({});try{var t;let r=E.phone.replace(/\D/g,""),a={...E,phone:r,password:(null==(t=E.password)?void 0:t.trim())||"changeme"},n=await fetch("".concat((0,u.e)(),"/admin/users"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},credentials:"include",body:JSON.stringify(a)}),s=await n.json();if(!n.ok){if(400===n.status&&Array.isArray(s.error)){let e=Object.fromEntries(s.error.map(e=>[e.path[0],e.message]));T(e);return}console.error("Erreur cr\xe9ation membre :",s);return}z(),g(!1)}catch(e){console.error("Erreur cr\xe9ation membre :",e)}finally{N(!1)}},B=t.slice(0,n),L=n<t.length;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(x,{title:"Gestion des membres",onCreate:()=>{S({firstname:"",lastname:"",email:"",phone:"",admin:!1}),A(!0),l(null),g(!0)},children:[(0,a.jsx)(j,{items:B.map(e=>({id:e.id,name:"".concat(e.firstname," ").concat(e.lastname)})),onEdit:e=>{var t;console.log("Membre \xe9dit\xe9 :",t=B[e]),l(t),S({firstname:t.firstname,lastname:t.lastname,email:t.email,phone:t.phone,admin:!!t.admin}),A(!1),h(!0)},onDelete:e=>(e=>{let r=t.find(t=>t.id===e);r&&(l(r),b(!0))})(B[e].id)}),(0,a.jsx)(m,{hasMore:L,onClick:()=>i(e=>e+4)})]}),(0,a.jsx)(c.A,{isOpen:p,title:"Modifier un membre",confirmText:"Modifier",onClose:()=>h(!1),onConfirm:O,disableConfirm:!E.firstname||!E.lastname||!E.email,loading:C,children:(0,a.jsx)(v,{form:E,setForm:S,isCreating:w,formErrors:k})}),(0,a.jsx)(c.A,{isOpen:f,title:"Supprimer un membre",confirmText:"Supprimer",onClose:()=>b(!1),onConfirm:_,loading:C,children:(0,a.jsx)("p",{className:"text-text font-body",children:"Voulez-vous vraiment supprimer ce membre ?"})}),(0,a.jsx)(c.A,{isOpen:y,title:"Cr\xe9er un membre",confirmText:"Cr\xe9er",onClose:()=>g(!1),onConfirm:P,disableConfirm:!E.firstname||!E.lastname||!E.email,loading:C,children:(0,a.jsx)(v,{form:E,setForm:S,isCreating:w,formErrors:k})})]})}function v(e){let{form:t,setForm:r,isCreating:n,formErrors:s}=e;return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("input",{type:"text",placeholder:"Pr\xe9nom",className:"w-full rounded p-2 border ".concat(s.firstname?"border-red-500":"border-muted"),"aria-invalid":!!s.firstname,value:t.firstname,onChange:e=>r(t=>({...t,firstname:e.target.value}))}),s.firstname&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:s.firstname}),(0,a.jsx)("input",{type:"text",placeholder:"Nom",className:"w-full rounded p-2 border ".concat(s.lastname?"border-red-500":"border-muted"),"aria-invalid":!!s.lastname,value:t.lastname,onChange:e=>r(t=>({...t,lastname:e.target.value}))}),s.lastname&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:s.lastname}),(0,a.jsx)("input",{type:"email",placeholder:"Email",className:"w-full rounded p-2 border ".concat(s.email?"border-red-500":"border-muted"),"aria-invalid":!!s.email,value:t.email,onChange:e=>r(t=>({...t,email:e.target.value}))}),s.email&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:s.email}),(0,a.jsx)("input",{type:"tel",placeholder:"T\xe9l\xe9phone",className:"w-full rounded p-2 border ".concat(s.phone?"border-red-500":"border-muted"),"aria-invalid":!!s.phone,value:t.phone,onChange:e=>r(t=>({...t,phone:e.target.value.replace(/\D/g,"").slice(0,10).replace(/(\d{2})(?=\d)/g,"$1 ").trim()}))}),s.phone&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:s.phone}),n&&(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"password",placeholder:"Mot de passe (optionnel)",className:"w-full rounded p-2 border ".concat(s.password?"border-red-500":"border-muted"),"aria-invalid":!!s.password,value:t.password||"",onChange:e=>r(t=>({...t,password:e.target.value}))}),s.password&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:s.password})]}),(0,a.jsxs)("label",{htmlFor:"admin",className:"flex items-center gap-2",children:[(0,a.jsx)("input",{id:"admin",type:"checkbox",checked:t.admin,onChange:e=>r(t=>({...t,admin:e.target.checked}))}),(0,a.jsx)("span",{children:"Admin"})]})]})}var C=r(7924);function N(){let{token:e}=(0,d.W)(),[t,r]=(0,s.useState)([]),[n,i]=(0,s.useState)(""),[p,h]=(0,s.useState)(4),[x,f]=(0,s.useState)("");async function b(){if(S){_(!0);try{(await fetch("".concat((0,u.e)(),"/admin/reservations/").concat(S.id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)},credentials:"include"})).ok&&(r(e=>e.filter(e=>e.id!==S.id)),w(!1),k(null))}catch(e){console.error("Erreur suppression :",e)}finally{_(!1)}}}async function j(){if(S&&T){B(!0);try{let t=new Date(T).toISOString();console.log("Date envoy\xe9e :",t),(await fetch("".concat((0,u.e)(),"/admin/reservations/").concat(S.id),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({visit_date:t}),credentials:"include"})).ok&&(r(e=>e.map(e=>e.id===S.id?{...e,visit_date:t}:e)),E(!1),k(null),z(""))}catch(e){console.error("Erreur modification :",e)}finally{B(!1)}}}(0,s.useEffect)(()=>{async function t(){try{let t=await fetch("".concat((0,u.e)(),"/admin/reservations"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)},credentials:"include"}),a=await t.json();r(a.reservations||[])}catch(e){console.error("Erreur lors du fetch des r\xe9servations :",e)}}e&&t()},[e]);let y=t.filter(e=>{let t=e.User&&"".concat(e.User.firstname," ").concat(e.User.lastname).toLowerCase().includes(n.toLowerCase()),r=!x||e.visit_date.startsWith(x);return t&&r}),g=y.slice(0,p),v=p<y.length,[N,w]=(0,s.useState)(!1),[A,E]=(0,s.useState)(!1),[S,k]=(0,s.useState)(null),[T,z]=(0,s.useState)(""),[O,_]=(0,s.useState)(!1),[P,B]=(0,s.useState)(!1);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("section",{className:"mb-10 text-text font-body",children:[(0,a.jsx)("div",{className:"flex justify-between items-center mb-3",children:(0,a.jsx)("h2",{className:"text-xl font-subtitle text-primary-light",children:"Gestion des r\xe9servations"})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 mb-3",children:[(0,a.jsxs)("label",{className:"relative flex-1",children:[(0,a.jsx)("input",{type:"search",placeholder:"Rechercher une r\xe9servation...",value:n,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2 rounded-md bg-surface text-text border border-muted"}),(0,a.jsx)(C.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-5 text-muted"})]}),(0,a.jsx)("label",{className:"relative w-full sm:w-auto",children:(0,a.jsx)("input",{type:"date",value:x,onChange:e=>f(e.target.value),className:"appearance-none pl-10 pr-4 py-2 rounded-md bg-surface text-text border border-muted w-full"})})]}),(0,a.jsx)("ul",{className:"space-y-2",children:g.map(e=>(0,a.jsxs)("li",{className:"flex justify-between items-center px-4 py-2 bg-surface border border-muted rounded",children:[(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:e.User?"".concat(e.User.firstname," ").concat(e.User.lastname):"Utilisateur inconnu"})," ","– ",new Date(e.visit_date).toLocaleDateString()]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{k(e),z(e.visit_date.slice(0,10)),E(!0)},className:"text-primary hover:text-primary-dark",children:(0,a.jsx)(o.A,{className:"size-4"})}),(0,a.jsx)("button",{type:"button",onClick:()=>(function(e){let r=t.find(t=>t.id===e);r&&(k(r),w(!0))})(e.id),className:"text-red-500 hover:text-red-700",children:(0,a.jsx)(l.A,{className:"size-4"})})]})]},e.id))}),(0,a.jsx)(m,{hasMore:v,onClick:()=>h(e=>e+4)})]}),(0,a.jsx)(c.A,{isOpen:N,onClose:()=>{w(!1),k(null)},title:"Confirmer la suppression",confirmText:"Supprimer",onConfirm:b,loading:O,children:(0,a.jsx)("p",{className:"text-text font-body",children:"\xcates-vous s\xfbr de vouloir supprimer cette r\xe9servation ?"})}),(0,a.jsx)(c.A,{isOpen:A,onClose:()=>{E(!1),k(null),z("")},title:"Modifier la r\xe9servation",confirmText:"Confirmer",onConfirm:j,disableConfirm:!T,loading:P,children:(0,a.jsx)("input",{type:"date",value:T,onChange:e=>z(e.target.value),className:"w-full mb-4 p-2 border rounded bg-bg text-text"})})]})}function w(){return(0,a.jsxs)("div",{className:"max-w-md mx-auto px-4 py-8 text-text font-body",children:[(0,a.jsx)("h1",{className:"text-3xl font-subtitle text-primary text-center mb-8 uppercase",children:"Admin Page"}),(0,a.jsx)(p,{}),(0,a.jsx)(y,{}),(0,a.jsx)(g,{}),(0,a.jsx)(N,{})]})}function A(){let{user:e,loading:t}=(0,d.W)(),r=(0,n.useRouter)();return((0,s.useEffect)(()=>{!t&&(null===e?r.replace("/connexion"):e.admin||r.replace("/unauthorized"))},[e,t,r]),t)?(0,a.jsx)("p",{className:"text-center mt-6",children:"Chargement..."}):(0,a.jsx)(w,{})}},4831:(e,t,r)=>{"use strict";r.d(t,{W:()=>c,x:()=>l});var a=r(5155),n=r(7383),s=r(2115),i=r(9509);let o=(0,s.createContext)({token:null,setToken:()=>{},user:null,loading:!0}),l=e=>{let{children:t}=e,[r,l]=(0,s.useState)(()=>n.A.get("zombieland_token")||null),[c,d]=(0,s.useState)(null),[u,m]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{(async()=>{if(!r){d(null),m(!1);return}try{let e=await fetch("".concat(i.env.NEXT_PUBLIC_API_URL,"/auth/verify"),{headers:{Authorization:"Bearer ".concat(r)},credentials:"include"});if(e.ok){let t=await e.json();d(t.user)}else n.A.remove("zombieland_token"),l(null),d(null)}catch(e){console.error("Erreur lors du check token :",e),n.A.remove("zombieland_token"),l(null),d(null)}finally{m(!1)}})()},[r]),(0,a.jsx)(o.Provider,{value:{token:r,setToken:e=>{e?(n.A.set("zombieland_token",e,{expires:1,secure:!0,sameSite:"strict"}),l(e)):(n.A.remove("zombieland_token"),l(null),d(null))},user:c,loading:u},children:t})},c=()=>(0,s.useContext)(o)},4837:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(5155);function n(e){let{isOpen:t,onClose:r,title:n,children:s,confirmText:i="Confirmer",onConfirm:o,disableConfirm:l=!1,loading:c=!1}=e;return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur z-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-bg rounded-lg p-6 w-full max-w-md shadow-lg",children:[(0,a.jsx)("h3",{className:"text-xl font-bold mb-4 text-primary font-subtitle uppercase",children:n}),(0,a.jsx)("div",{className:"text-text font-body mb-4",children:s}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:r,className:"px-3 py-1 rounded bg-muted text-bg hover:bg-muted/80 transition font-subtitle uppercase",children:"Annuler"}),o&&(0,a.jsx)("button",{type:"button",onClick:o,disabled:l||c,className:"px-3 py-1 rounded font-subtitle uppercase transition ".concat(i.toLowerCase().includes("supprim")||i.toLowerCase().includes("annul")?"bg-red-600 hover:bg-red-700":"bg-primary text-black hover:bg-primary-dark"," disabled:opacity-50"),children:c?"Envoi…":i})]})]})}):null}},6008:(e,t,r)=>{Promise.resolve().then(r.bind(r,2440))}},e=>{e.O(0,[320,441,964,358],()=>e(e.s=6008)),_N_E=e.O()}]);