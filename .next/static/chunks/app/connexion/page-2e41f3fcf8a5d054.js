(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[106],{306:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(9946).A)("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]])},2383:(e,t,r)=>{"use strict";r.d(t,{e:()=>o});var n=r(9509);function o(){if(!n.env.NEXT_PUBLIC_API_URL)throw Error("NEXT_PUBLIC_API_URL n'est pas d\xe9finie.");return n.env.NEXT_PUBLIC_API_URL}},4831:(e,t,r)=>{"use strict";r.d(t,{W:()=>c,x:()=>l});var n=r(5155),o=r(7383),a=r(2115),s=r(9509);let i=(0,a.createContext)({token:null,setToken:()=>{},user:null,loading:!0}),l=e=>{let{children:t}=e,[r,l]=(0,a.useState)(()=>o.A.get("zombieland_token")||null),[c,u]=(0,a.useState)(null),[d,p]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{(async()=>{if(!r){u(null),p(!1);return}try{let e=await fetch("".concat(s.env.NEXT_PUBLIC_API_URL,"/auth/verify"),{headers:{Authorization:"Bearer ".concat(r)},credentials:"include"});if(e.ok){let t=await e.json();u(t.user)}else o.A.remove("zombieland_token"),l(null),u(null)}catch(e){console.error("Erreur lors du check token :",e),o.A.remove("zombieland_token"),l(null),u(null)}finally{p(!1)}})()},[r]),(0,n.jsx)(i.Provider,{value:{token:r,setToken:e=>{e?(o.A.set("zombieland_token",e,{expires:1,secure:!0,sameSite:"strict"}),l(e)):(o.A.remove("zombieland_token"),l(null),u(null))},user:c,loading:d},children:t})},c=()=>(0,a.useContext)(i)},5695:(e,t,r)=>{"use strict";var n=r(8999);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},6308:(e,t,r)=>{Promise.resolve().then(r.bind(r,8827))},7383:(e,t,r)=>{"use strict";function n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}r.d(t,{A:()=>o});var o=function e(t,r){function o(e,o,a){if("undefined"!=typeof document){"number"==typeof(a=n({},r,a)).expires&&(a.expires=new Date(Date.now()+864e5*a.expires)),a.expires&&(a.expires=a.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var i in a)a[i]&&(s+="; "+i,!0!==a[i]&&(s+="="+a[i].split(";")[0]));return document.cookie=e+"="+t.write(o,e)+s}}return Object.create({set:o,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},o=0;o<r.length;o++){var a=r[o].split("="),s=a.slice(1).join("=");try{var i=decodeURIComponent(a[0]);if(n[i]=t.read(s,i),e===i)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){o(e,"",n({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,n({},this.attributes,t))},withConverter:function(t){return e(n({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})},8827:(e,t,r)=>{"use strict";r.d(t,{default:()=>p});var n=r(5155),o=r(7383),a=r(306),s=r(6874),i=r.n(s),l=r(5695),c=r(2115),u=r(4831),d=r(2383);function p(){let{setToken:e}=(0,u.W)(),t=(0,l.useRouter)(),r=(0,l.useSearchParams)(),[s,p]=(0,c.useState)("votre@email.com"),[m,f]=(0,c.useState)("password"),[h,x]=(0,c.useState)(""),v=r.get("redirect")||"/",g=async n=>{n.preventDefault(),x("");try{var a;let n=await fetch("".concat((0,d.e)(),"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,password:m}),credentials:"include"});if(!n.ok)throw Error("Invalid credentials or server error");let i=await n.json();e(i.token),o.A.set("token",i.token,{secure:!0,sameSite:"strict"}),(null==(a=i.user)?void 0:a.mustChangePassword)&&alert("⚠️ Votre mot de passe est toujours 'changeme'. Veuillez le modifier depuis votre profil.");let l=r.get("redirect")||"/reservations";t.push(l)}catch(e){e instanceof Error?(console.error(e),x("Identifiants invalides ou erreur serveur.")):(console.error("Unknown error",e),x("Erreur inconnue."))}};return(0,n.jsxs)("form",{onSubmit:g,className:"flex flex-col gap-4 w-full max-w-xl mx-auto bg-surface bg-opacity-90 backdrop-blur-sm p-6 rounded-lg border border-primary shadow-lg",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsx)("label",{htmlFor:"email",className:"text-primary-light font-subtitle uppercase tracking-wide text-xl",children:"Email"}),(0,n.jsx)("input",{id:"email",name:"email",type:"email",placeholder:"votre@email.com",value:s,onChange:e=>p(e.target.value),required:!0,className:"bg-bg text-text border border-muted rounded-lg px-3 py-2 focus:outline-none focus:border-primary placeholder:text-muted font-body text xl"})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsx)("label",{htmlFor:"password",className:"text-primary-light font-subtitle uppercase tracking-wide text-xl",children:"Mot de passe"}),(0,n.jsx)("input",{id:"password",name:"password",type:"password",placeholder:"password",value:m,onChange:e=>f(e.target.value),required:!0,className:"bg-bg text-text border border-muted rounded-lg px-3 py-2 focus:outline-none focus:border-primary placeholder:text-muted font-body text-xl"})]}),h&&(0,n.jsx)("p",{className:"text-red-500 text-sm font-body",children:h}),(0,n.jsxs)("button",{type:"submit",className:"bg-primary text-black font-subtitle uppercase tracking-wide py-2 rounded-lg hover:bg-primary-dark transition flex items-center justify-center gap-2",children:[(0,n.jsx)(a.A,{size:18}),"Me connecter"]}),(0,n.jsxs)("p",{className:"mt-4 text-sm text-center",children:["Pas encore de compte ?"," ",(0,n.jsx)(i(),{href:"/inscription".concat(v?"?redirect=".concat(encodeURIComponent(v)):""),className:"text-primary hover:underline",children:"Cr\xe9ez un compte ici"})]})]})}},9946:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n=r(2115);let o=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:o=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:c="",children:u,iconNode:d,...p}=e;return(0,n.createElement)("svg",{ref:t,...s,width:o,height:o,stroke:r,strokeWidth:l?24*Number(i)/Number(o):i,className:a("lucide",c),...!u&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(p)&&{"aria-hidden":"true"},...p},[...d.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),l=(e,t)=>{let r=(0,n.forwardRef)((r,s)=>{let{className:l,...c}=r;return(0,n.createElement)(i,{ref:s,iconNode:t,className:a("lucide-".concat(o(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),l),...c})});return r.displayName=o(e),r}}},e=>{e.O(0,[874,441,964,358],()=>e(e.s=6308)),_N_E=e.O()}]);